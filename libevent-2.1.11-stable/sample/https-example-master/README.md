## This is probably not what you are looking for

Understandably, given that the name of the repository is
`https-example`, I believe that a lot of people are coming here
expecting to find an example of how to write an https server and/or
client using [libevent](https://libevent.org/) and
[OpenSSL](https://www.openssl.org/).

Instead, this was something I threw together in 2013 as an
example of a *problem* I was having when writing an https client and
server using libevent and OpenSSL.  I only posted it so I could
[discuss it on the libevent mailing list](http://archives.seul.org/libevent/users/Jan-2013/msg00055.html).
I've kept it up in case it is useful to someone reading the mailing
list archives, and because a number of people have starred or forked
the repository.

If you're looking for an https *client* using libevent and
OpenSSL, I would recommend checking out
[the example that comes with libevent](https://github.com/libevent/libevent/blob/master/sample/https-client.c).
If you're looking for an https *server* using libevent and OpenSSL, I
don't know of one to recommend.  You might want to try asking on the
[libevent mailing list](http://archives.seul.org/libevent/users/).

If you still want to look at the code in this repository, beware that
the client and server are written to work together.  The server only
responds to a particular `POST` request generated by the client.
(This is because this example is a simplified version of some programs
I was writing at the time.)  So if you want a general-purpose server,
you'll need to modify it to respond to `GET` requests, at the very
least.

## Original README

```
ppelletier@chives:~/src/https-example$ uname -a
Linux chives 2.6.32-34-generic #77-Ubuntu SMP Tue Sep 13 19:39:17 UTC 2011 x86_64 GNU/Linux

start the server:

ppelletier@chives:~/src/https-example$ ./https-server
Using OpenSSL version "OpenSSL 1.0.1c 10 May 2012"
and libevent version "2.1.2-alpha-dev"
Loading certificate chain from 'server-certificate-chain.pem'
and private key from 'server-private-key.pem'
Listening on 0.0.0.0:8421

run the client... it works!

ppelletier@chives:~/src/https-example$ ./https-client
Using OpenSSL version "OpenSSL 1.0.1c 10 May 2012"
and libevent version "2.1.2-alpha-dev"
https server 'localhost' has this certificate, which looks good to me:
/C=US/ST=CA/L=Los Angeles/O=Oblong Industries/OU=Plasma/CN=localhost
server said: Hi 127.0.0.1!  I liked your passcode.

do the same thing with curl instead of with the client:

ppelletier@chives:~/src/https-example$ curl -k -d 'passcode=R23' https://localhost:8421/
Hi 127.0.0.1!  I liked your passcode.

Now, change the "#if 1" on line 214 of https-client.c to "#if 0", to
get rid of the special hack that turns "localhost" into "127.0.0.1",
in order to avoid IPv6.  Here's what happens:

ppelletier@chives:~/src/https-example$ ./https-client
Using OpenSSL version "OpenSSL 1.0.1c 10 May 2012"
and libevent version "2.1.2-alpha-dev"
code=0  POST failed
server said:

Next, change the "#if 0" on line 100 of https-client.c to "#if 1", to
enable retries:

ppelletier@chives:~/src/https-example$ ./https-client
Using OpenSSL version "OpenSSL 1.0.1c 10 May 2012"
and libevent version "2.1.2-alpha-dev"
[warn] Epoll ADD(1) on fd 7 failed.  Old events were 0; read change was 1 (add); write change was 0 (none): Bad file descriptor
[warn] Epoll ADD(4) on fd 7 failed.  Old events were 0; read change was 0 (none); write change was 1 (add): Bad file descriptor
code=0  POST failed
socket error = Bad file descriptor (9)
server said: (null)
```
